Имеется исходный Dataframe, содержайщий информацию о сбойных событиях 1 категории за 2024 год на объектах Управления вагонного хозяйства Центральной дирекции инфраструктуры – филиала ОАО «РЖД» (далее УВХ):
1) histogram.pdf - гистограмма интервалов между сбойными событиями;
2) detect_changes.pdf - график накопленного числа событий c условным выделением участков с разной интенсивностью;
3) df.csv - Dataframe с исходными данными.

Алгоритм обрабатывает каждый из выделенных участков:
1) С помощью библиотеки fitter определяет наиболее походящие параметры экспоненциального распределения для каждого из участков;
1.1) С помощью Теста Колмогорова–Смирнова производится проверка, что мы можем использовать полученные параметры экспоненциального распределения для гненрации нового Dataframe;
1.2) Для визиуальной демонстрации, что мы можем использовать полученные параметры экспоненциального распределения для гненрации нового Dataframe, строятся отдельные Probability–Probability Plot для каждого из выделенных отрезков в
начальной Dataframe (pp_plot_part_0.png, pp_plot_part_1.png, pp_plot_part_2.png);
1.3) exp_fit_results.xlsx - файл с краткой информацией о полученных результатах.

Генерация Dataframe с изменением интенсивности сбойных событий в определенные промежутки времени. Интенсивность сбойных событий может принимать значения, выявленные на предыдущем шаге (указаны в exp_fit_results.xlsx):
1) Функциия generate_segmented_exponential_dataset - генерация единого DataFrame с экспоненциальными выборками, составленными из нескольких сегментов;
2) Функция add_start_times - добавляет поле 'START_TIME', обозначающим время возникновения сбойного события;
3) df_exp.csv - сгенерированный Datadrame;
4) histogram_exp.pdf - гистограмма интервалов между сбойными событиями для сгенерированного Datadrame;
5) nce_plot.pdf - график накопленного числа событий c выделением участков с разной интенсивностью.

Вопрос в том, как наиболее корректно применить метод CUSUM для сгенерированного Dataframe? Как математически должна выглядеть функция для применения метода CUSUM?
Во многом похожий алгоритм применения метода CUSUM к экспоненциальному распределению описан в блок-схеме CUSUM_exp.pdf

Результаты работы программы выложил на Google Диск - https://drive.google.com/drive/folders/16KjnZWPh3_6PyzjFAvyznzVnH5KPV2NW
Исходный код опубликовал в репозитории GitHub - https://github.com/repin1378/TS_ANALYSIS# (исполняемый файл для запуска программы  - test/main.py).

